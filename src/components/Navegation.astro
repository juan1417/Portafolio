---
import { getTranslations, type Language } from '../i18n/utils'

interface Props {
  lang?: Language;
}

const lang = (Astro.url.searchParams.get('lang') || 'en') as Language;
const t = getTranslations(lang)
---

<nav class="flex items-center justify-between p-4 bg-surface">
  <div class="flex items-center gap-3">
    <img src="" alt="" class="w-20 h-auto" />
    <h2 class="text-text text-xl font-bold">CodingSpace </h2>
  </div>
  <div class="flex items-center gap-6">
    <ul class="flex gap-6 list-none">
      <li>
        <a
          href="/"
          class="text-text-muted hover:text-primary cursor-pointer transition-colors"
          >{t.nav.home}</a>
      </li>
      <li>
        <a
          href="#projects"
          class="text-text-muted hover:text-primary cursor-pointer transition-colors"
          >{t.nav.projects}</a>
      </li>
      <li>
        <a
          href="/skills"
          class="text-text-muted hover:text-primary cursor-pointer transition-colors"
          >{t.nav.skills}</a>
      </li>
      <li>
        <a
          href="#about"
          class="text-text-muted hover:text-primary cursor-pointer transition-colors"
          >{t.nav.about}</a>
      </li>
    </ul>
    <form class="flex items-center gap-2">
      <span class="material-symbols-outlined text-text-muted text-xl">language</span>
      <label for="language-select" class="sr-only">{t.language.select}</label>
      <select
        id="language-select"
        name="language"
        class="bg-surface-elevated text-text px-3 py-1 rounded border border-primary/20 focus:outline-none focus:border-primary cursor-pointer font-['Inter']"
        aria-label={t.language.select}
      >
        <option value="en" selected={lang === 'en'}>English</option>
        <option value="es" selected={lang === 'es'}>Espa√±ol</option>
      </select>
    </form>
  </div>
</nav>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const select = document.getElementById('language-select') as HTMLSelectElement
    const currentLang = new URLSearchParams(window.location.search).get('lang') || 'en'
    
    if (select) {
      select.value = currentLang
      
      select.addEventListener('change', (e) => {
        const newLang = (e.target as HTMLSelectElement).value
        console.log(newLang);
        
        const url = new URL(window.location.href)
        url.searchParams.set('lang', newLang)
        window.location.href = url.toString()
      })
    }
  })
</script>

<style></style>
